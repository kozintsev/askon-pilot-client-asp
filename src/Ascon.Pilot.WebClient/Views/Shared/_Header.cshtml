<div class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a asp-controller="Home" asp-action="Index" class="navbar-brand">
                <span title="Статус сервера" class="serverStatusIndicator connecting"></span> АСКОН Pilot-ICE
            </a>
        </div>
        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li></li>
                <li><a asp-controller="Home" asp-action="Index">Home</a></li>
                <li><a asp-controller="Home" asp-action="About">About</a></li>
                <li><a asp-controller="Home" asp-action="Contact">Contact</a></li>
            </ul>
        </div>
    </div>
</div>

<style>
    .serverStatusIndicator {
        display: inline-block;
        vertical-align: baseline;
        border-radius: 50%;
        min-height: 10px;
        min-width: 10px;
        padding: 5px 0px;
    }

    .online { background-color: lightgreen; }

    .offline { background-color: lightcoral; }

    .connecting { background-color: orange; }
</style>

<script type="text/javascript">
    window.onload = defer(checkIfServerOnline);
    
    function defer(method) {
        if (typeof window.jQuery !== "undefined")
            method();
        else
            setTimeout(function() { defer(method) }, 50);
    }

    function checkIfServerOnline() {
        $.ajax({
            url: "http://localhost:5545/web/connect",
            success: function() {
                $('.serverStatusIndicator').removeClass('connecting').addClass('online');
            },
            error: function() {
                $('.serverStatusIndicator').removeClass('connecting').addClass('offline');
            }
        });
    }
</script>

